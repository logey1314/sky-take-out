# Java外卖项目模拟面试总结

## 面试时间
2024年面试记录

## 项目背景
基于Spring Boot的外卖系统项目，使用JWT认证、MyBatis、分页查询等技术

---

## 第一轮：项目概述

### Q1: 请简单介绍项目的整体架构和主要功能模块

**我的回答：** 
common里面是这个项目一些公共的东西比如异常，配置，封装规则等等，pojo就放置了一些实体类，vo，dto实体等，server模块是核心业务层，描写了处理业务的逻辑。

**评价：** ✅ 正确
**标准答案：**
- sky-common: 公共模块，包含工具类、常量、异常处理、配置类等
- sky-pojo: 实体模块，包含Entity、DTO、VO等数据传输对象
- sky-server: 业务模块，包含Controller、Service、Mapper等业务逻辑

---

## 第二轮：技术细节深入

### Q2: JWT认证的完整工作流程是什么？

**我的回答：** 
jwt工作流程就是用户登录成功后，会给他一个令牌进行存储，以后再执行他业务的时候，会要验证令牌的有效性，应该是让aop进行拦截。

**评价：** ⚠️ 部分正确，但有技术错误
**我的不足：**
1. 说成了AOP拦截，实际是拦截器(Interceptor)
2. 流程描述不够详细

**标准答案：**
1. 用户登录 → 验证用户名密码
2. 验证成功 → 生成JWT token（包含用户ID等信息）
3. 返回token给前端 → 前端存储token
4. 后续请求 → 前端在请求头携带token
5. 拦截器验证token → 解析获取用户信息
6. 验证通过 → 放行请求，失败返回401

### Q3: JWT解析失败时如何优化异常处理？

**我的回答：** 
目前我的代码应该指挥返回401错误码，但是前端不知道什么错误，优化的话我觉得应该是可以在加几个判断条件，根据不同的条件给前端返回一些错误信息。

**评价：** ✅ 思路正确
**标准答案：**
```java
try {
    Claims claims = JwtUtil.parseJWT(jwtProperties.getAdminSecretKey(), token);
    // ...
} catch (ExpiredJwtException e) {
    throw new TokenExpiredException("Token已过期");
} catch (MalformedJwtException e) {
    throw new TokenInvalidException("Token格式错误");
} catch (SignatureException e) {
    throw new TokenInvalidException("Token签名验证失败");
}
```

### Q4: 为什么使用ThreadLocal？

**我的回答：** 
ThreadLocal我任务是一个线程上下文变量，因为用户发出一个请求后的执行过程是同一个线程，那么server层就可以直接通过这个获取相关id，而不是由上一层传递过来，这样也可以解耦。

**评价：** ✅ 理解正确
**我的不足：** 不了解ThreadLocal的内存泄漏风险

**标准答案：**
- **作用：** 线程间数据隔离，避免参数层层传递
- **原理：** 每个线程都有独立的ThreadLocalMap
- **风险：** 在Web应用中使用线程池时可能造成内存泄漏
- **解决：** 使用后及时调用remove()方法清理

---

## 第三轮：技术纠正与深入

### Q5: 拦截器和AOP有什么区别？

**我的回答：** 
第一个我不知道

**评价：** ❌ 需要学习
**标准答案：**
| 特性 | 拦截器(Interceptor) | AOP |
|------|-------------------|-----|
| 作用范围 | 只能拦截Controller请求 | 可以拦截任何Spring管理的Bean |
| 执行时机 | DispatcherServlet处理过程中 | 方法调用前后 |
| 实现方式 | 基于Spring MVC | 基于代理模式 |
| 使用场景 | 权限验证、日志记录 | 事务管理、缓存、日志 |

### Q6: ThreadLocal内存泄漏问题

**我的回答：** 
也没有了解过

**评价：** ❌ 需要学习
**标准答案：**
- **原因：** ThreadLocal的key是弱引用，但value是强引用
- **场景：** Web应用使用线程池，线程不销毁但ThreadLocal对象被回收
- **后果：** value无法被GC回收，造成内存泄漏
- **解决：** 使用完毕后调用remove()方法

---

## 第四轮：代码质量问题

### Q7: 自动填充AOP中直接取args[0]有什么风险？

**我的回答：** 
不会

**评价：** ❌ 存在风险意识不足
**标准答案：**
```java
// 风险代码
Object entity = args[0];

// 优化后
Object[] args = joinPoint.getArgs();
if (args == null || args.length == 0) {  // 注意顺序
    return;
}
Object entity = args[0];
// 还需要类型检查
if (!(entity instanceof BaseEntity)) {
    return;
}
```

### Q8: 直接抛出RuntimeException合适吗？

**我的回答：** 
可能太笼统了

**评价：** ⚠️ 意识到问题但不够深入
**标准答案：**
- **问题：** RuntimeException太笼统，不利于异常处理和调试
- **优化：** 自定义具体的业务异常
```java
catch (NoSuchMethodException e) {
    throw new AutoFillException("自动填充失败：方法不存在");
} catch (IllegalAccessException e) {
    throw new AutoFillException("自动填充失败：方法访问权限不足");
}
```

---

## 第五轮：数据库与并发

### Q9: 菜品删除时如何处理历史订单？

**我的回答：** 
我会假删除，我可以让这个菜品的状态改变，但是数据库中还有

**评价：** ✅ 思路正确
**标准答案：**
- **软删除：** 添加deleted字段标记删除状态
- **数据一致性：** 历史订单仍能查看已删除菜品信息
- **查询优化：** 正常查询需要过滤deleted=0的数据

### Q10: 并发问题如何解决？

**我的回答：** 
没了解过并发

**评价：** ❌ 需要学习
**标准答案：**
- **乐观锁：** 使用version字段，适合读多写少
- **悲观锁：** 使用SELECT FOR UPDATE，适合写多场景
- **分布式锁：** 使用Redis实现，适合分布式环境
- **消息队列：** 异步处理，削峰填谷

---

## 第六轮：缓存与性能

### Q11: Redis的使用场景

**我的回答：** 
redis目前用来存储店铺状态，因为单独用数据包存一个字段比较浪费，而且用户量大了性能不好。

**评价：** ✅ 理解正确
**标准答案：**
- **缓存热点数据：** 减少数据库压力
- **会话存储：** 分布式session
- **计数器：** 点赞数、访问量等
- **分布式锁：** 解决并发问题
- **消息队列：** 发布订阅模式

### Q12: 缓存一致性问题

**我的回答：** 
redis我现在是刚学

**评价：** ❌ 需要学习
**标准答案：**
- **Cache Aside模式：** 先更新数据库，再删除缓存
- **Write Through：** 同时更新缓存和数据库
- **Write Behind：** 先更新缓存，异步更新数据库
- **双写一致性：** 使用分布式事务保证

---

## 第七轮：MyBatis与事务

### Q13: 注解vs XML配置的选择

**我的回答：** 
简单用注解，复杂动态用xml文件

**评价：** ✅ 正确
**标准答案：**
- **注解适用：** 简单CRUD，SQL较短
- **XML适用：** 复杂查询，动态SQL，SQL较长
- **维护性：** XML更利于SQL维护和调试

### Q14: 事务回滚机制

**我的回答：** 
不会，事务回滚

**评价：** ✅ 正确
**标准答案：**
- **原子性：** 要么全部成功，要么全部失败
- **回滚条件：** 默认RuntimeException和Error会回滚
- **手动回滚：** 可以通过TransactionAspectSupport.currentTransactionStatus().setRollbackOnly()

---

## 第八轮：项目经验

### Q15: 开发中遇到的问题

**我的回答：** 
这个项目是我的第一个项目，都是别人写好的接口我进行敲代码

**评价：** ✅ 诚实，符合新手情况

### Q16: 学习方法

**我的回答：** 
问ai

**评价：** ⚠️ 方法单一
**建议：**
- **多元化学习：** 官方文档 + 视频教程 + 实践项目
- **深入理解：** 不只知道怎么用，还要知道为什么
- **社区参与：** GitHub、Stack Overflow、技术博客

---

## 总体评价

### 优势
1. ✅ 基础概念理解正确
2. ✅ 对项目结构有清晰认识
3. ✅ 诚实面对不足，学习态度好
4. ✅ 软删除、事务等核心概念掌握

### 需要加强的方面
1. ❌ 并发处理机制
2. ❌ 缓存策略和一致性
3. ❌ 异常处理的细化
4. ❌ 性能优化意识
5. ❌ 代码质量和安全意识

### 学习建议
1. **深入学习并发编程**：线程安全、锁机制、并发工具类
2. **掌握缓存技术**：Redis深入使用、缓存策略、一致性方案
3. **提升代码质量**：异常处理、参数校验、代码规范
4. **系统设计思维**：高可用、高并发、分布式系统设计
5. **实践项目**：从模仿到创新，尝试添加新功能

### 下一步学习路径
1. **巩固基础**：Spring Boot深入、MyBatis高级特性
2. **扩展技术栈**：Redis、RabbitMQ、Elasticsearch
3. **微服务架构**：Spring Cloud、Docker、K8s
4. **性能优化**：JVM调优、数据库优化、系统监控

## 面试表现评分
- **基础知识：** 7/10
- **项目理解：** 8/10  
- **技术深度：** 5/10
- **学习能力：** 8/10
- **综合评价：** 7/10

继续加油！💪